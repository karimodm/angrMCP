import subprocess
import sys

def check_exploit(command):
    """
    Runs the provided command and checks if it results in root privileges.
    """
    print(f"Testing exploit command: {command}")
    
    try:
        # Run the command and check 'id'
        # We wrap it in a shell to allow complex commands
        full_cmd = f"{command}; id"
        output = subprocess.check_output(full_cmd, shell=True, stderr=subprocess.STDOUT, timeout=5)
        output_str = output.decode('utf-8')
        
        print(f"Output:\n{output_str}")
        
        if "uid=0(root)" in output_str:
            print("SUCCESS: Root privileges obtained!")
            return True
        else:
            print("FAILURE: Did not get root.")
            return False
            
    except subprocess.CalledProcessError as e:
        print(f"Error running command: {e.output.decode('utf-8')}")
        return False
    except Exception as e:
        print(f"An error occurred: {e}")
        return False

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python3 exploit_check.py '<exploit_command>'")
        sys.exit(1)
        
    exploit_cmd = sys.argv[1]
    if check_exploit(exploit_cmd):
        sys.exit(0)
    else:
        sys.exit(1)
