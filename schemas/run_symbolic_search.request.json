{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "run_symbolic_search request",
  "type": "object",
  "additionalProperties": false,
  "required": ["project_id"],
  "properties": {
    "project_id": {"$ref": "common.json#/$defs/uuid"},
    "state_id": {"$ref": "common.json#/$defs/uuid"},
    "simgr_id": {"$ref": "common.json#/$defs/uuid"},
    "job_id": {"$ref": "common.json#/$defs/uuid"},
    "mode": {
      "type": "string",
      "enum": ["step", "explore"],
      "default": "explore"
    },
    "find": {
      "type": "array",
      "items": {"$ref": "common.json#/$defs/hex-address"}
    },
    "avoid": {
      "type": "array",
      "items": {"$ref": "common.json#/$defs/hex-address"}
    },
    "step_count": {
      "type": "integer",
      "minimum": 1,
      "default": 1
    },
    "techniques": {
      "type": "array",
      "items": {"type": "string"}
    },
    "persist_job": {
      "type": "boolean",
      "default": false
    },
    "job_metadata": {
      "type": "object",
      "description": "Optional metadata merged into the job record after the run."
    }
  },
  "allOf": [
    {
      "if": {"not": {"required": ["simgr_id"]}},
      "then": {
        "required": ["state_id"]
      }
    }
  ]
}
